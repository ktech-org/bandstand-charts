# Bandstand web service

## Global values

| Key                | Type   | Default | Description                                           |
|--------------------|--------|---------|-------------------------------------------------------|
| global.aws.account | string |         | The AWS account the helm chart is installed into      |
| global.env         | string |         | The environment, either test, preprod or prod         |
| global.image.tag   | string |         | The tag for container image to be used in the service |

## Values

| Key                                 | Type   | Default                          | Description                                                                                                                                                                                                                                                                                         |
|-------------------------------------|--------|----------------------------------|-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| additionalDomains                   | list   | `[]`                             | A list of additional domains for the service                                                                                                                                                                                                                                                        |
| additionalEnvVars                   | object | `{}`                             | An object containing additional environment variables                                                                                                                                                                                                                                               |
| environmentEnvVars                  | object | `{}`                             | An object containing environment specific additional environment variables                                                                                                                                                                                                                          |
| containerPort                       | int    | `8080`                           | The port to open on the container for the service                                                                                                                                                                                                                                                   |
| dockerRegistry                      | string | `ktechartifacts-docker.jfrog.io` | Docker registry to pull images from                                                                                                                                                                                                                                                                 |
| gitRepo                             | string | `.Release.Name`                  | The name of the repository for the service                                                                                                                                                                                                                                                          |
| hpa.averageCpuUtilization           | int    | `50`                             | Horizontal pod autoscaler, the threshold average CPU ultilization to trigger, see [here](https://kubernetes.io/docs/tasks/run-application/horizontal-pod-autoscale/)                                                                                                                                |
| hpa.maxReplicas                     | int    | `3`                              | Horizontal pod autoscaler, maximum number of pods, see [here](https://kubernetes.io/docs/tasks/run-application/horizontal-pod-autoscale/)                                                                                                                                                           |
| hpa.minReplicas                     | int    | `1`                              | Horizontal pod autoscaler, minimum number of pods, see [here](https://kubernetes.io/docs/tasks/run-application/horizontal-pod-autoscale/)                                                                                                                                                           |
| imagePullSecret                     | string | `rt-docker-config`               | Docker registry secret for pulling image                                                                                                                                                                                                                                                            |
| ingress.annotations                 | object | `{}`                             | Additional annotations to apply to the ingress object                                                                                                                                                                                                                                               |
| ingress.domain                      | string |                                  | Primary ingress domain for service, normally ktech.com                                                                                                                                                                                                                                              |
| ingress.enabled                     | bool   |                                  | True if the service has an ingress                                                                                                                                                                                                                                                                  |
| ingress.visibility                  | string |                                  | Whether service is externally visible, either cluster, private or public                                                                                                                                                                                                                            |
| ingress.defaultBackend              | string | `.Release.Name`                  | The name of the service to host at the `/` path                                                                                                                                                                                                                                                     |
| ingress.additionalPaths             | string | `.Release.Name`                  | Additional path rules to apply to the ingress host, see [here](https://kubernetes.io/docs/concepts/services-networking/ingress/#the-ingress-resource) and [here](https://kubernetes.io/docs/reference/generated/kubernetes-api/v1.19/#httpingresspath-v1-networking-k8s-io)                         |
| livenessProbe.path                  | string | `/`                              | Path to the endpoint used to determine whether a container is active                                                                                                                                                                                                                                |
| nameSuffix                          | string |                                  | A suffix to be appended to the name of all created resources. This is useful when using subcharts to define multiple services within a single helm release                                                                                                                                          |
| owner                               | string |                                  | The GitHub team that owns the service                                                                                                                                                                                                                                                               |
| config                              | object | `{}`                             | An object containing base config for the service - use this for creating base config files.                                                                                                                                                                                                         |
| envConfig                           | object | `{}`                             | An object containing environment config for the service - use this for creating environment specific config files.                                                                                                                                                                                  |
| readinessProbe.path                 | string | `/`                              | Path to the endpoint used to determine whether a container is ready                                                                                                                                                                                                                                 |
| resources.requests.cpu              | string | `100m`                           | [Requests](https://kubernetes.io/docs/concepts/configuration/manage-resources-containers/#requests-and-limits) for container CPU resources measured in cpu units, one core is 1000m, see [here](https://kubernetes.io/docs/concepts/configuration/manage-resources-containers/#meaning-of-cpu)      |
| resources.requests.memory           | string | `512Mi`                          | Container memory [Requests and Limit](https://kubernetes.io/docs/concepts/configuration/manage-resources-containers/#requests-and-limits)see [here](https://kubernetes.io/docs/concepts/configuration/manage-resources-containers/#meaning-of-memory) (both set to the same value)                  |
| resources.requests.ephemeralStorage | string | `64Mi`                           | Container ephemeral storage [Requests and Limit](https://kubernetes.io/docs/concepts/configuration/manage-resources-containers/#requests-and-limits)see [here](https://kubernetes.io/docs/concepts/configuration/manage-resources-containers/#local-ephemeral-storage) (both set to the same value) |
| runAsUser                           | number | 1000                             | The user id to run the container as (cannot be 0/root)                                                                                                                                                                                                                                              |
| serverContainer.arguments           | list   |                                  | Override the default container (Helm) arguments (this is the docker CMD) for the service Pod                                                                                                                                                                                                        |
| serverContainer.command             | string |                                  | Override the default container (Helm) command (this is the docker ENTRYPOINT) for the service Pod                                                                                                                                                                                                   |
| systemCode                          | string | `.Release.Name`                  | The systemCode for the service                                                                                                                                                                                                                                                                      |
| systemGroup                         | string |                                  | The systemGroup for the service                                                                                                                                                                                                                                                                     |
| test.additionalEnvVars              | object | `{}`                             | An object containing additional environment variables                                                                                                                                                                                                                                               |
| test.environmentEnvVars             | object | `{}`                             | An object containing environment specific additional environment variables                                                                                                                                                                                                                          |
| test.resources.requests.memory      | string | `512Mi`                          | Test container memory                                                                                                                                                                                                                                                                               |
| testContainer.arguments             | list   |                                  | Override the default container (Helm) arguments (this is the docker CMD) for the test Pod                                                                                                                                                                                                           |
| testContainer.command               | string |                                  | Override the default container (Helm) command (this is the docker ENTRYPOINT) for the test Pod                                                                                                                                                                                                      |
| volume.enabled                      | bool   |                                  | True if persistent volume is required                                                                                                                                                                                                                                                               |
| volume.storage                      | string | `1Gi`                            | Amount of volume storage                                                                                                                                                                                                                                                                            |
